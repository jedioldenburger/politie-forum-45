# Dual URL System - News Articles

## Overview

The news ripper (`news-rip.py`) can generate articles in **three different modes**:

1. **Next.js Only** - Firebase Realtime Database for dynamic pages
2. **Static HTML Only** - Pre-generated HTML files
3. **Both** (Default) - Dual system with both outputs

## How to Choose Output Mode

Run `news-rip.py` and select **Menu Option 15: Kies output mode**

```
15. Kies output mode (huidig: BOTH)
```

You'll see three options:

```
1. Next.js Only - Alleen Firebase Realtime Database (dynamische pagina's)
2. Static HTML Only - Alleen statische HTML bestanden
3. Both - Zowel Next.js als statische HTML (aanbevolen)

üí° Voordelen per mode:
   Next.js: Real-time updates, interactieve features, comments
   Static HTML: Snelste laadtijd, offline toegang, eenvoudige hosting
   Both: Beste van beide werelden
```

## Mode Comparison

### 1. Static HTML Files
**URL Format**: `https://politie-forum.nl/nieuws/{slug}/`
- **Location**: `/public/nieuws/{slug}/index.html`
- **Generated by**: `generate_static_html()` function (line ~697)
- **Characteristics**:
  - Direct file access
  - Requires trailing slash `/`
  - Faster initial load (no server processing)
  - Pre-rendered HTML with all content
  - Best for SEO and social media crawlers

### 2. Next.js Dynamic Routes
**URL Format**: `https://politie-forum.nl/nieuws/{slug}`
- **Data Source**: Firebase Realtime Database at `/news/{slug}`
- **Generated by**: `save_article_to_firebase()` function (line ~657)
- **Characteristics**:
  - No trailing slash
  - Server-side rendering with React
  - Real-time data from Firebase
  - Full Next.js features (comments, auth, etc.)
  - Better for interactive features

## Technical Details

### How Output Mode Works

The `output_mode` variable in `news-rip.py` controls article generation:

```python
# Global variable (line ~48)
output_mode = "both"  # Options: "nextjs", "static", "both"

# In advanced rewriter (line ~1638)
if output_mode in ["nextjs", "both"]:
    save_article_to_firebase(rewritten_data)  # Firebase save
    revalidate_vercel_path(rewritten_data["slug"])  # Cache refresh

if output_mode in ["static", "both"]:
    generate_static_html(rewritten_data)  # Static HTML file
```

### File Locations

**Next.js Mode:**
- Database: Firebase Realtime Database `/news/{slug}`
- Code: `src/app/nieuws/[slug]/page.tsx`
- Component: `src/app/nieuws/[slug]/ArticleClient.tsx`

**Static HTML Mode:**
- Files: `/public/nieuws/{slug}/index.html`
- Template: `static-article-template.html`
- Function: `generate_static_html()` (line ~697)

---

## Recommendations

### For Production Sites
**Use: Next.js Only** (`output_mode = "nextjs"`)
- Cleaner, no duplicate content
- Better user experience with comments
- Easier to maintain

### For Maximum Speed
**Use: Static HTML Only** (`output_mode = "static"`)
- Fastest possible load times
- Great for news sites without interactivity

### For Development/Testing
**Use: Both** (`output_mode = "both"`)
- Compare performance
- Test different approaches
- Gradual migration

---

## Migration Guide

### From Both ‚Üí Next.js Only

1. Set output mode: Menu Option 15 ‚Üí Choose 1
2. Existing static files remain (optional: delete manually)
3. New articles only save to Firebase
4. Update internal links to remove trailing slashes

### From Both ‚Üí Static Only

1. Set output mode: Menu Option 15 ‚Üí Choose 2
2. Existing Firebase data remains
3. New articles only generate HTML
4. Disable Next.js dynamic routes (optional)

---

## Mode Comparison

### 1. Next.js Only Mode (`output_mode = "nextjs"`)

**What It Does:**
- Saves articles to Firebase Realtime Database only
- Powers Next.js dynamic routes at `/nieuws/[slug]`
- No static HTML files generated

**URL Format**: `https://politie-forum.nl/nieuws/{slug}` (no trailing slash)

**Advantages:**
- ‚úÖ Real-time data updates
- ‚úÖ Full Firebase integration (comments, auth, etc.)
- ‚úÖ Smaller storage footprint
- ‚úÖ Easier to update/modify content
- ‚úÖ Single source of truth

**Use When:**
- You want dynamic, interactive pages
- Comments and user features are important
- Content changes frequently

---

### 2. Static HTML Only Mode (`output_mode = "static"`)

**What It Does:**
- Generates pre-rendered HTML files only
- Files saved to `/public/nieuws/{slug}/index.html`
- No Firebase Realtime Database save

**URL Format**: `https://politie-forum.nl/nieuws/{slug}/` (with trailing slash)

**Advantages:**
- ‚úÖ Fastest page load (no server processing)
- ‚úÖ Works offline
- ‚úÖ Simple hosting (any web server)
- ‚úÖ Best for SEO crawlers
- ‚úÖ No database dependencies

**Use When:**
- Maximum speed is priority
- Content is mostly static
- You want simple deployment

---

### 3. Both Mode (`output_mode = "both"`) - DEFAULT

**What It Does:**
- Saves to Firebase Realtime Database
- Generates static HTML files
- Creates both URL versions

**URL Formats:**
- Static: `https://politie-forum.nl/nieuws/{slug}/`
- Dynamic: `https://politie-forum.nl/nieuws/{slug}`

**Advantages:**
- ‚úÖ Best of both worlds
- ‚úÖ Fallback if one system fails
- ‚úÖ Static files for speed, Firebase for features
- ‚úÖ Users can access either URL

**Use When:**
- You want maximum flexibility
- Both speed AND features matter
- You're testing/comparing approaches

---

## Technical Details

## Recent Fixes (Oct 8, 2025)

### ‚úÖ Summary HTML Stripping
**Problem**: Meta descriptions showed `&lt;p&gt;&lt;h3&gt;` instead of clean text

**Solution**: Updated `generate_summary()` function (line ~572) to strip HTML tags:
```python
def generate_summary(full_text, char_limit=59):
    """Generate summary from full text, stripping HTML tags"""
    import re
    clean_text = re.sub(r"<[^>]+>", "", full_text).strip()
    # ... rest of function
```

**Impact**: Clean text in all meta descriptions for both static and dynamic pages

### ‚úÖ Title Quote Removal
**Problem**: AI-generated titles wrapped in quotes: `"Title here"`

**Solution**: Added quote stripping in title cleanup (line ~1488):
```python
rewritten_title = rewritten_title.strip('"').strip("'")
```

**Impact**: Clean titles without surrounding quotes

## Recommendation

Both systems work together:
- **Static HTML**: Great for initial page load and social sharing
- **Next.js Dynamic**: Powers interactive features like comments and real-time updates

Users can access either URL - they show the same content with different rendering approaches.

## Files Modified

- `news-rip.py` line ~572: `generate_summary()` - HTML stripping
- `news-rip.py` line ~1488: Title quote removal
- `news-rip.py` line ~657: `save_article_to_firebase()` - Next.js data
- `news-rip.py` line ~697: `generate_static_html()` - Static files

---

## Quick Reference

| Mode | Firebase | Static HTML | URL Format | Best For |
|------|----------|-------------|------------|----------|
| **Next.js Only** | ‚úÖ Yes | ‚ùå No | `/nieuws/{slug}` | Interactive sites, comments |
| **Static Only** | ‚ùå No | ‚úÖ Yes | `/nieuws/{slug}/` | Speed, simple hosting |
| **Both** (Default) | ‚úÖ Yes | ‚úÖ Yes | Both URLs work | Testing, flexibility |

### Commands

```bash
# Run news ripper
python3 news-rip.py

# Menu Options
15 - Change output mode (nextjs/static/both)
10 - Start advanced rewriting (uses current mode)
```

### Code References

- **Output mode variable**: `news-rip.py` line ~48
- **Mode selection function**: `set_output_mode()` line ~1730
- **Generation logic**: `start_advanced_rewriting()` line ~1638
- **Firebase save**: `save_article_to_firebase()` line ~657
- **Static HTML**: `generate_static_html()` line ~697

---

## Recent Fixes (Oct 8, 2025)

### ‚úÖ Summary HTML Stripping
**Problem**: Meta descriptions showed `&lt;p&gt;&lt;h3&gt;` instead of clean text

**Solution**: Updated `generate_summary()` function (line ~572) to strip HTML tags:
```python
def generate_summary(full_text, char_limit=59):
    """Generate summary from full text, stripping HTML tags"""
    import re
    clean_text = re.sub(r"<[^>]+>", "", full_text).strip()
    # ... rest of function
```

**Impact**: Clean text in all meta descriptions for both static and dynamic pages

### ‚úÖ Title Quote Removal
**Problem**: AI-generated titles wrapped in quotes: `"Title here"`

**Solution**: Added quote stripping in title cleanup (line ~1488):
```python
rewritten_title = rewritten_title.strip('"').strip("'")
```

**Impact**: Clean titles without surrounding quotes

### ‚úÖ Output Mode Selection
**Added**: Menu option to choose between Next.js, Static HTML, or Both
**Benefit**: Flexibility to use either system or both based on needs

---

**Last Updated**: October 8, 2025
